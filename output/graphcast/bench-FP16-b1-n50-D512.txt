[1/3] c++ -MMD -MF cpu.o.d -DTORCH_EXTENSION_NAME=cpu_unsorted_segsum -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -isystem /u/d/e/deep/miniconda3/envs/casio-torch/lib/python3.9/site-packages/torch/include -isystem /u/d/e/deep/miniconda3/envs/casio-torch/lib/python3.9/site-packages/torch/include/torch/csrc/api/include -isystem /u/d/e/deep/miniconda3/envs/casio-torch/lib/python3.9/site-packages/torch/include/TH -isystem /u/d/e/deep/miniconda3/envs/casio-torch/lib/python3.9/site-packages/torch/include/THC -isystem /u/d/e/deep/miniconda3/envs/casio-torch/include/python3.9 -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -fopenmp -O3 -march=native -c /nobackup.1/deep/graphcast_mlp/unsorted_segsum/cpu.cc -o cpu.o 
[2/3] c++ -MMD -MF cpu_extension.o.d -DTORCH_EXTENSION_NAME=cpu_unsorted_segsum -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -isystem /u/d/e/deep/miniconda3/envs/casio-torch/lib/python3.9/site-packages/torch/include -isystem /u/d/e/deep/miniconda3/envs/casio-torch/lib/python3.9/site-packages/torch/include/torch/csrc/api/include -isystem /u/d/e/deep/miniconda3/envs/casio-torch/lib/python3.9/site-packages/torch/include/TH -isystem /u/d/e/deep/miniconda3/envs/casio-torch/lib/python3.9/site-packages/torch/include/THC -isystem /u/d/e/deep/miniconda3/envs/casio-torch/include/python3.9 -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -fopenmp -O3 -march=native -c /nobackup.1/deep/graphcast_mlp/unsorted_segsum/cpu_extension.cc -o cpu_extension.o 
[3/3] c++ cpu_extension.o cpu.o -shared -lgomp -O3 -march=native -L/u/d/e/deep/miniconda3/envs/casio-torch/lib/python3.9/site-packages/torch/lib -lc10 -ltorch_cpu -ltorch -ltorch_python -o cpu_unsorted_segsum.so
[1/4] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=cuda_unsorted_segsum -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -isystem /u/d/e/deep/miniconda3/envs/casio-torch/lib/python3.9/site-packages/torch/include -isystem /u/d/e/deep/miniconda3/envs/casio-torch/lib/python3.9/site-packages/torch/include/torch/csrc/api/include -isystem /u/d/e/deep/miniconda3/envs/casio-torch/lib/python3.9/site-packages/torch/include/TH -isystem /u/d/e/deep/miniconda3/envs/casio-torch/lib/python3.9/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /u/d/e/deep/miniconda3/envs/casio-torch/include/python3.9 -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -std=c++14 -c /nobackup.1/deep/graphcast_mlp/unsorted_segsum/cuda_kernel.cu -o cuda_kernel.cuda.o 
[2/4] c++ -MMD -MF cuda_extension.o.d -DTORCH_EXTENSION_NAME=cuda_unsorted_segsum -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -isystem /u/d/e/deep/miniconda3/envs/casio-torch/lib/python3.9/site-packages/torch/include -isystem /u/d/e/deep/miniconda3/envs/casio-torch/lib/python3.9/site-packages/torch/include/torch/csrc/api/include -isystem /u/d/e/deep/miniconda3/envs/casio-torch/lib/python3.9/site-packages/torch/include/TH -isystem /u/d/e/deep/miniconda3/envs/casio-torch/lib/python3.9/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /u/d/e/deep/miniconda3/envs/casio-torch/include/python3.9 -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -fopenmp -O3 -march=native -c /nobackup.1/deep/graphcast_mlp/unsorted_segsum/cuda_extension.cc -o cuda_extension.o 
[3/4] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=cuda_unsorted_segsum -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -isystem /u/d/e/deep/miniconda3/envs/casio-torch/lib/python3.9/site-packages/torch/include -isystem /u/d/e/deep/miniconda3/envs/casio-torch/lib/python3.9/site-packages/torch/include/torch/csrc/api/include -isystem /u/d/e/deep/miniconda3/envs/casio-torch/lib/python3.9/site-packages/torch/include/TH -isystem /u/d/e/deep/miniconda3/envs/casio-torch/lib/python3.9/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /u/d/e/deep/miniconda3/envs/casio-torch/include/python3.9 -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -std=c++14 -c /nobackup.1/deep/graphcast_mlp/unsorted_segsum/cuda.cu -o cuda.cuda.o 
[4/4] c++ cuda_extension.o cuda.cuda.o cuda_kernel.cuda.o -shared -lgomp -O3 -march=native -L/u/d/e/deep/miniconda3/envs/casio-torch/lib/python3.9/site-packages/torch/lib -lc10 -lc10_cuda -ltorch_cpu -ltorch_cuda_cu -ltorch_cuda_cpp -ltorch -ltorch_python -L/usr/local/cuda/lib64 -lcudart -o cuda_unsorted_segsum.so
NI =  50 BS =  1 D =  512 MP =  1 mode =  bench
Batch Size: 1
Num Iters: 50
Elapsed time: 16.43 seconds
Throughput: 3.04 samp/sec
